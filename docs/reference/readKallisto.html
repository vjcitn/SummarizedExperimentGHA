<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Input kallisto or kallisto bootstrap results. — readKallisto • SummarizedExperimentGHA</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Input kallisto or kallisto bootstrap results. — readKallisto" />
<meta property="og:description" content="WARNING: readKallisto() is deprecated. Please use tximeta()
  from the tximeta package instead.
readKallisto inputs several kallisto output files into a single
  SummarizedExperiment instance, with rows corresponding to
  estimated transcript abundance and columns to
  samples. readKallistoBootstrap inputs kallisto bootstrap
  replicates of a single sample into a matrix of transcript x bootstrap
  abundance estimates." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SummarizedExperimentGHA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.23.5003</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Extensions.html">Extending the SummarizedExperiment class</a>
    </li>
    <li>
      <a href="../articles/SummarizedExperiment.html">_SummarizedExperiment_ for Coordinating Experimental Assays, Samples, and Regions of Interest</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/vjcitn/SummarizedExperimentGHA">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Input kallisto or kallisto bootstrap results.</h1>
    
    <div class="hidden name"><code>readKallisto.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>WARNING: <code>readKallisto()</code> is deprecated. Please use <code>tximeta()</code>
  from the <span class="pkg">tximeta</span> package instead.</p>
<p><code>readKallisto</code> inputs several kallisto output files into a single
  <code>SummarizedExperiment</code> instance, with rows corresponding to
  estimated transcript abundance and columns to
  samples. <code>readKallistoBootstrap</code> inputs kallisto bootstrap
  replicates of a single sample into a matrix of transcript x bootstrap
  abundance estimates.</p>
    </div>

    <pre class="usage"><span class='fu'>readKallisto</span><span class='op'>(</span><span class='va'>files</span>,
    json <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/BiocGenerics/man/path.html'>dirname</a></span><span class='op'>(</span><span class='va'>files</span><span class='op'>)</span>, <span class='st'>"run_info.json"</span><span class='op'>)</span>, 
    h5 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/any.html'>any</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/BiocGenerics/man/grep.html'>grepl</a></span><span class='op'>(</span><span class='st'>"\\.h5$"</span>, <span class='va'>files</span><span class='op'>)</span><span class='op'>)</span>, what <span class='op'>=</span> <span class='va'>KALLISTO_ASSAYS</span>,
    as <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/S4Vectors/man/Vector-class.html'>c</a></span><span class='op'>(</span><span class='st'>"SummarizedExperiment"</span>, <span class='st'>"list"</span>, <span class='st'>"matrix"</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'>readKallistoBootstrap</span><span class='op'>(</span><span class='va'>file</span>, <span class='va'>i</span>, <span class='va'>j</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>files</th>
      <td><p>character() paths to kallisto &#8216;abundance.tsv&#8217;
    output files. The assumption is that files are organized in the way
    implied by kallisto, with each sample in a distinct directory, and
    the directory containing files abundance.tsv, run_info.json, and
    perhaps abundance.h5.</p></td>
    </tr>
    <tr>
      <th>json</th>
      <td><p>character() vector of the same length as <code>files</code>
    specifying the location of JSON files produced by kallisto and
    containing information on the run. The default assumes that json
    files are in the same directory as the corresponding abundance
    file.</p></td>
    </tr>
    <tr>
      <th>h5</th>
      <td><p>character() vector of the same length as <code>files</code>
    specifying the location of HDF5 files produced by kallisto and
    containing bootstrap estimates. The default assumes that HDF5 files
    are in the same directory as the corresponding abundance file.</p></td>
    </tr>
    <tr>
      <th>what</th>
      <td><p>character() vector of kallisto per-sample outputs to be
    input. See KALLISTO_ASSAYS for available values.</p></td>
    </tr>
    <tr>
      <th>as</th>
      <td><p>character(1) specifying the output format. See <code>Value</code>
    for additional detail.</p></td>
    </tr>
    <tr>
      <th>file</th>
      <td><p>character(1) path to a single HDF5 output file.</p></td>
    </tr>
    <tr>
      <th>i, j</th>
      <td><p>integer() vector of row (<code>i</code>) and column (<code>j</code>)
    indexes to input.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    

<p>A <code>SummarizedExperiment</code>, <code>list</code>, or <code>matrix</code>,
  depending on the value of argument <code>as</code>; by default a
  <code>SummarizedExperiment</code>. The <code>as="SummarizedExperiment"</code>
  <code>rowData(se)</code> the length of each transcript;
  <code>colData(se)</code> includes summary information on each sample,
  including the number of targets and bootstraps, the kallisto and index
  version, the start time and operating system call used to create the
  file. <code><a href='SummarizedExperiment-class.html'>assays()</a></code> contains one or more transcript x sample
  matrices of parameters estimated by kallisto (see
  <code>KALLISTO_ASSAYS</code>).</p>
<p><code>as="list"</code> return value contains information simillar to
  <code>SummarizedExperiment</code> with row, column and assay data as
  elements of the list without coordination of row and column
  annotations into an integrated data container. <code>as="matrix"</code>
  returns the specified assay as a simple <em>R</em> matrix.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p><a href='http://pachterlab.github.io/kallisto'>http://pachterlab.github.io/kallisto</a> software for quantifying
  transcript abundance.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Martin Morgan <a href='martin.morgan@roswellpark.org'>martin.morgan@roswellpark.org</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='r-in'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span></span>
<span class='r-in'><span class='va'>outputs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span>package<span class='op'>=</span><span class='st'>"SummarizedExperiment"</span>, <span class='st'>"extdata"</span>,</span>
<span class='r-in'>    <span class='st'>"kallisto"</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>files</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>dir</a></span><span class='op'>(</span><span class='va'>outputs</span>, pattern<span class='op'>=</span><span class='st'>"abundance.tsv"</span>, full<span class='op'>=</span><span class='cn'>TRUE</span>, recursive<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/stopifnot.html'>stopifnot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.html'>all</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/files.html'>file.exists</a></span><span class='op'>(</span><span class='va'>files</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## default: input 'est_counts'</span></span>
<span class='r-in'><span class='op'>(</span><span class='va'>se</span> <span class='op'>&lt;-</span> <span class='fu'>readKallisto</span><span class='op'>(</span><span class='va'>files</span>, as<span class='op'>=</span><span class='st'>"SummarizedExperiment"</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='fu'>readKallisto</span><span class='op'>(</span><span class='va'>files</span>, as<span class='op'>=</span><span class='st'>"list"</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='fu'>readKallisto</span><span class='op'>(</span><span class='va'>files</span>, as<span class='op'>=</span><span class='st'>"matrix"</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## available assays</span></span>
<span class='r-in'><span class='va'>KALLISTO_ASSAYS</span></span>
<span class='r-in'><span class='co'>## one or more assay</span></span>
<span class='r-in'><span class='fu'>readKallisto</span><span class='op'>(</span><span class='va'>files</span>, what<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/pkg/S4Vectors/man/Vector-class.html'>c</a></span><span class='op'>(</span><span class='st'>"tpm"</span>, <span class='st'>"eff_length"</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## alternatively: read hdf5 files</span></span>
<span class='r-in'><span class='va'>files</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>sub</a></span><span class='op'>(</span><span class='st'>".tsv"</span>, <span class='st'>".h5"</span>, <span class='va'>files</span>, fixed<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'>readKallisto</span><span class='op'>(</span><span class='va'>files</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## input all bootstraps</span></span>
<span class='r-in'><span class='va'>xx</span> <span class='op'>&lt;-</span> <span class='fu'>readKallistoBootstrap</span><span class='op'>(</span><span class='va'>files</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>ridx</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/S4Vectors/man/Vector-class.html'>head</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/BiocGenerics/man/which.html'>which</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/DelayedArray/man/DelayedMatrix-stats.html'>rowSums</a></span><span class='op'>(</span><span class='va'>xx</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>0</span><span class='op'>)</span>, <span class='fl'>3</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>cidx</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/S4Vectors/man/Vector-class.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span>, <span class='fl'>96</span><span class='op'>:</span><span class='fl'>100</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>xx</span><span class='op'>[</span><span class='va'>ridx</span>, <span class='va'>cidx</span><span class='op'>]</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## selective input of rows (transcripts) and/or bootstraps</span></span>
<span class='r-in'><span class='fu'>readKallistoBootstrap</span><span class='op'>(</span><span class='va'>files</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, i<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/pkg/S4Vectors/man/Vector-class.html'>c</a></span><span class='op'>(</span><span class='va'>ridx</span>, <span class='fu'><a href='https://rdrr.io/pkg/S4Vectors/man/Vector-class.html'>rev</a></span><span class='op'>(</span><span class='va'>ridx</span><span class='op'>)</span><span class='op'>)</span>, j<span class='op'>=</span><span class='va'>cidx</span><span class='op'>)</span></span>
<span class='r-in'><span class='op'>}</span></span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Bioconductor Maintainer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


