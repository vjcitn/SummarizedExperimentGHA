<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Extending the SummarizedExperiment class • SummarizedExperimentGHA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Extending the SummarizedExperiment class">
<meta property="og:description" content="SummarizedExperimentGHA">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SummarizedExperimentGHA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.23.5003</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Extensions.html">Extending the SummarizedExperiment class</a>
    </li>
    <li>
      <a href="../articles/SummarizedExperiment.html">_SummarizedExperiment_ for Coordinating Experimental Assays, Samples, and Regions of Interest</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/vjcitn/SummarizedExperimentGHA">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Extensions_files/header-attrs-2.11/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Extending the SummarizedExperiment class</h1>
                        <h4 class="author">Aaron Lun</h4>
            
            <h4 class="date">Revised: 30 October, 2018</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/vjcitn/SummarizedExperimentGHA/blob/master/vignettes/Extensions.Rmd"><code>vignettes/Extensions.Rmd</code></a></small>
      <div class="hidden name"><code>Extensions.Rmd</code></div>

    </div>

    
    
<div id="motivation" class="section level1">
<h1 class="hasAnchor">
<a href="#motivation" class="anchor"></a>Motivation</h1>
<p>A large number of Bioconductor packages contain extensions of the standard <code>SummarizedExperiment</code> class from the <a href="https://bioconductor.org/packages/SummarizedExperiment">SummarizedExperiment</a> package. This allows developers to take advantage of the power of the <code>SummarizedExperiment</code> representation for synchronising data and metadata, while still accommodating specialized data structures for particular scientific applications. This document is intended to provide a developer-level “best practices” reference for the creation of these derived classes.</p>
</div>
<div id="deriving-a-simple-class" class="section level1">
<h1 class="hasAnchor">
<a href="#deriving-a-simple-class" class="anchor"></a>Deriving a simple class</h1>
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p>To introduce various concepts, we will start off with a simple derived class that does not add any new slots. This is occasionally useful when additional constraints need to be placed on the derived class. In this example, we will assume that we want our class to minimally hold a <code>"counts"</code> assay that contains non-negative values<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>.</p>
</div>
<div id="defining-the-class-and-its-constructor" class="section level2">
<h2 class="hasAnchor">
<a href="#defining-the-class-and-its-constructor" class="anchor"></a>Defining the class and its constructor</h2>
<p>We name our new class <code>CountSE</code> and define it using the <code>setClass</code> function from the <em>methods</em> package, as is conventionally done for all S4 classes. We use Roxygen’s <code>#'</code> tags to trigger the generation of import/export statements in the <code>NAMESPACE</code> of our package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @export</span>
<span class="co">#' @import methods</span>
<span class="co">#' @importClassesFrom SummarizedExperiment SummarizedExperiment</span>
<span class="va">.CountSE</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/methods/setClass.html">setClass</a></span><span class="op">(</span><span class="st">"CountSE"</span>, contains<span class="op">=</span><span class="st">"SummarizedExperiment"</span><span class="op">)</span></code></pre></div>
<p>We define a constructor that accepts a count matrix to create a <code>CountSE</code> object. We use <code>...</code> to pass further arguments to the <code>SummarizedExperiment</code> constructor, which allows us to avoid re-specifying all its arguments.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @export</span>
<span class="co">#' @importFrom SummarizedExperiment SummarizedExperiment</span>
<span class="va">CountSE</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">counts</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RangedSummarizedExperiment-class.html">SummarizedExperiment</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>counts<span class="op">=</span><span class="va">counts</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span>
    <span class="fu">.CountSE</span><span class="op">(</span><span class="va">se</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
<div id="defining-a-validity-method" class="section level2">
<h2 class="hasAnchor">
<a href="#defining-a-validity-method" class="anchor"></a>Defining a validity method</h2>
<p>We define a validity method that enforces the constraints that we described earlier. This is done by defining a validity function using <code>setValidity2</code> from the <a href="https://bioconductor.org/packages/S4Vectors">S4Vectors</a> package<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>. Returning a string indicates that there is a problem and triggers an error in the R session.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/S4Vectors-internals.html">setValidity2</a></span><span class="op">(</span><span class="st">"CountSE"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">msg</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>

    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="../reference/SummarizedExperiment-class.html">assayNames</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">!=</span> <span class="st">"counts"</span><span class="op">)</span> <span class="op">{</span>
        <span class="va">msg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="va">msg</span>, <span class="st">"'counts' must be first assay"</span><span class="op">)</span>
    <span class="op">}</span>

    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="fu"><a href="../reference/SummarizedExperiment-class.html">assay</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span>
        <span class="va">msg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="va">msg</span>, <span class="st">"negative values in 'counts'"</span><span class="op">)</span>
    <span class="op">}</span>

    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">msg</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
        <span class="cn">TRUE</span>
    <span class="op">}</span> <span class="kw">else</span> <span class="va">msg</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
<pre><code>## Class "CountSE" [in ".GlobalEnv"]
## 
## Slots:
##                                                                               
## Name:            colData            assays             NAMES   elementMetadata
## Class:         DataFrame    Assays_OR_NULL character_OR_NULL         DataFrame
##                         
## Name:           metadata
## Class:              list
## 
## Extends: 
## Class "SummarizedExperiment", directly
## Class "RectangularData", by class "SummarizedExperiment", distance 2
## Class "Vector", by class "SummarizedExperiment", distance 2
## Class "Annotated", by class "SummarizedExperiment", distance 3
## Class "vector_OR_Vector", by class "SummarizedExperiment", distance 3</code></pre>
<p>The constructor yields the expected output when counts are provided:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">CountSE</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="fl">100</span>, lambda<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## class: CountSE 
## dim: 20 5 
## metadata(0):
## assays(1): counts
## rownames: NULL
## rowData names(0):
## colnames: NULL
## colData names(0):</code></pre>
<p>… and an (expected) error otherwise:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">CountSE</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in validObject(.Object): invalid class "CountSE" object: 
##     negative values in 'counts'</code></pre>
</div>
<div id="defining-a-getter-method" class="section level2">
<h2 class="hasAnchor">
<a href="#defining-a-getter-method" class="anchor"></a>Defining a getter method</h2>
<p>A generic is a group of functions with the same name that operate on different classes. Upon calling the generic on an object, the S4 dispatch system will choose the most appropriate function to use based on the object class. This allows users and developers to write code that is agnostic to the type of input class.</p>
<p>Let’s say that it is of particular scientific interest to obtain the counts with a flipped sign. We observe that there are no existing generics that do this task, e.g., in <a href="https://bioconductor.org/packages/BiocGenerics">BiocGenerics</a> or <a href="https://bioconductor.org/packages/S4Vectors">S4Vectors</a><a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>. Instead, we define a new generic <code>negcounts</code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @export</span>
<span class="kw"><a href="https://rdrr.io/r/methods/setGeneric.html">setGeneric</a></span><span class="op">(</span><span class="st">"negcounts"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/standardGeneric.html">standardGeneric</a></span><span class="op">(</span><span class="st">"negcounts"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "negcounts"</code></pre>
<p>We then define a specific method for our <code>CountSE</code> class<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @export</span>
<span class="co">#' @importFrom SummarizedExperiment assay</span>
<span class="kw"><a href="https://rdrr.io/r/methods/setMethod.html">setMethod</a></span><span class="op">(</span><span class="st">"negcounts"</span>, <span class="st">"CountSE"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">withDimnames</span><span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span>
    <span class="op">-</span><span class="fu"><a href="../reference/SummarizedExperiment-class.html">assay</a></span><span class="op">(</span><span class="va">x</span>, withDimnames<span class="op">=</span><span class="va">withDimnames</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
<p>If any other developers need to compute negative counts for their own classes, they can simply use the <code>negcounts</code> generic defined in our package.</p>
</div>
<div id="some-comments-on-package-organization" class="section level2">
<h2 class="hasAnchor">
<a href="#some-comments-on-package-organization" class="anchor"></a>Some comments on package organization</h2>
<p>It is convention to put all class definitions (i.e., the <code>setClass</code> statement) in a file named <code>AllClasses.R</code>, all new generic definitions in a file named <code>AllGenerics.R</code>, and all method definitions in files that are alphanumerically ordered below the first two. This is because R collates files by alphanumeric order when building a package. It is critical that the collation (and definition) of the classes and generics occurs <strong>before</strong> that of the corresponding methods, otherwise errors will occur. If alphanumeric ordering is inappropriate, developers can manually specify the collation order using <code>Collate:</code> in the <code>DESCRIPTION</code> file - see <a href="https://cran.r-project.org/doc/manuals/r-release/R-exts.html#The-DESCRIPTION-file">Writing R Extensions</a> for more details.</p>
</div>
</div>
<div id="deriving-a-class-with-custom-slots" class="section level1">
<h1 class="hasAnchor">
<a href="#deriving-a-class-with-custom-slots" class="anchor"></a>Deriving a class with custom slots</h1>
<div id="class-definition" class="section level2">
<h2 class="hasAnchor">
<a href="#class-definition" class="anchor"></a>Class definition</h2>
<p>In practice, most derived classes will need to store application-specific data structures. For the rest of this document, we will be considering the derivation of a class with custom slots to hold such structures. First, we consider 1D data structures:</p>
<ul>
<li>
<code>rowVec</code>: 1:1 mapping from each value to a row of the <code>SummarizedExperiment</code>.</li>
<li>
<code>colVec</code>: 1:1 mapping from each value to a column of the <code>SummarizedExperiment</code>.</li>
</ul>
<p>Any 1D structure can be used if it supports <code>length</code>, <code>c</code>, <code>[</code> and <code>[&lt;-</code>. For simplicity, we will use integer vectors for the <code>*.vec</code> slots.</p>
<p>We also consider some 2D data structures:</p>
<ul>
<li>
<code>rowToRowMat</code>: 1:1 mapping from each row to a row of the <code>SummarizedExperiment</code>.</li>
<li>
<code>colToColMat</code>: 1:1 mapping from each column to a column of the <code>SummarizedExperiment</code>.</li>
<li>
<code>rowToColMat</code>: 1:1 mapping from each row to a column of the <code>SummarizedExperiment</code>.</li>
<li>
<code>colToRowMat</code>: 1:1 mapping from each column to a row of the <code>SummarizedExperiment</code>.</li>
</ul>
<p>Any 2D structure can be used if it supports <code>nrow</code>, <code>ncol</code>, <code>cbind</code>, <code>rbind</code>, <code>[</code> and <code>[&lt;-</code>. For simplicity, we will use (numeric) matrices for the <code>*.mat</code> slots.</p>
<p>Definition of the class is achieved using <code>setClass</code>, using the <code>slots=</code> argument to specify the new custom slots<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @export</span>
<span class="co">#' @import methods</span>
<span class="co">#' @importClassesFrom SummarizedExperiment SummarizedExperiment</span>
<span class="va">.ExampleClass</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/methods/setClass.html">setClass</a></span><span class="op">(</span><span class="st">"ExampleClass"</span>,
    slots<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/methods/representation.html">representation</a></span><span class="op">(</span>
        rowVec<span class="op">=</span><span class="st">"integer"</span>,
        colVec<span class="op">=</span><span class="st">"integer"</span>,
        rowToRowMat<span class="op">=</span><span class="st">"matrix"</span>,
        colToColMat<span class="op">=</span><span class="st">"matrix"</span>,
        rowToColMat<span class="op">=</span><span class="st">"matrix"</span>,
        colToRowMat<span class="op">=</span><span class="st">"matrix"</span>
    <span class="op">)</span>,
    contains<span class="op">=</span><span class="st">"SummarizedExperiment"</span>
<span class="op">)</span></code></pre></div>
</div>
<div id="defining-the-constructor" class="section level2">
<h2 class="hasAnchor">
<a href="#defining-the-constructor" class="anchor"></a>Defining the constructor</h2>
<p>The constructor should provide some arguments for setting the new slots in the derived class definition. The default values should be set such that calling the constructor without any arguments returns a valid <code>ExampleClass</code> object.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @export</span>
<span class="co">#' @importFrom SummarizedExperiment SummarizedExperiment</span>
<span class="va">ExampleClass</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span>
    <span class="va">rowVec</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html">integer</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, 
    <span class="va">colVec</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html">integer</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>,
    <span class="va">rowToRowMat</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,
    <span class="va">colToColMat</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,
    <span class="va">rowToColMat</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,
    <span class="va">colToRowMat</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,
    <span class="va">...</span><span class="op">)</span>
<span class="op">{</span>
    <span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RangedSummarizedExperiment-class.html">SummarizedExperiment</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span>
    <span class="fu">.ExampleClass</span><span class="op">(</span><span class="va">se</span>, rowVec<span class="op">=</span><span class="va">rowVec</span>, colVec<span class="op">=</span><span class="va">colVec</span>,
        rowToRowMat<span class="op">=</span><span class="va">rowToRowMat</span>, colToColMat<span class="op">=</span><span class="va">colToColMat</span>, 
        rowToColMat<span class="op">=</span><span class="va">rowToColMat</span>, colToRowMat<span class="op">=</span><span class="va">colToRowMat</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
<div id="creating-getter-methods" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-getter-methods" class="anchor"></a>Creating getter methods</h2>
<div id="for-1d-data-structures" class="section level3">
<h3 class="hasAnchor">
<a href="#for-1d-data-structures" class="anchor"></a>For 1D data structures</h3>
<p>We define some getter generics for the custom slots containing the 1D structures.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @export</span>
<span class="kw"><a href="https://rdrr.io/r/methods/setGeneric.html">setGeneric</a></span><span class="op">(</span><span class="st">"rowVec"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/standardGeneric.html">standardGeneric</a></span><span class="op">(</span><span class="st">"rowVec"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "rowVec"</code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @export</span>
<span class="kw"><a href="https://rdrr.io/r/methods/setGeneric.html">setGeneric</a></span><span class="op">(</span><span class="st">"colVec"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/standardGeneric.html">standardGeneric</a></span><span class="op">(</span><span class="st">"colVec"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "colVec"</code></pre>
<p>We then define the class-specific methods for these generics. Note the <code>withDimnames=TRUE</code> argument, which enforces consistency between the names of the extracted object and the original <code>SummarizedExperiment</code>. It is possible to turn this off for greater efficiency, e.g., for internal usage where names are not necessary.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @export</span>
<span class="kw"><a href="https://rdrr.io/r/methods/setMethod.html">setMethod</a></span><span class="op">(</span><span class="st">"rowVec"</span>, <span class="st">"ExampleClass"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">withDimnames</span><span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">out</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">@</span><span class="va">rowVec</span>
    <span class="kw">if</span> <span class="op">(</span><span class="va">withDimnames</span><span class="op">)</span> 
        <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">rownames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
    <span class="va">out</span>
<span class="op">}</span><span class="op">)</span>

<span class="co">#' @export</span>
<span class="kw"><a href="https://rdrr.io/r/methods/setMethod.html">setMethod</a></span><span class="op">(</span><span class="st">"colVec"</span>, <span class="st">"ExampleClass"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">withDimnames</span><span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">out</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">@</span><span class="va">colVec</span>
    <span class="kw">if</span> <span class="op">(</span><span class="va">withDimnames</span><span class="op">)</span> 
        <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">colnames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
    <span class="va">out</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
<div id="for-2d-data-structures" class="section level3">
<h3 class="hasAnchor">
<a href="#for-2d-data-structures" class="anchor"></a>For 2D data structures</h3>
<p>We repeat this process for the 2D structures.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @export</span>
<span class="kw"><a href="https://rdrr.io/r/methods/setGeneric.html">setGeneric</a></span><span class="op">(</span><span class="st">"rowToRowMat"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/standardGeneric.html">standardGeneric</a></span><span class="op">(</span><span class="st">"rowToRowMat"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "rowToRowMat"</code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @export</span>
<span class="kw"><a href="https://rdrr.io/r/methods/setGeneric.html">setGeneric</a></span><span class="op">(</span><span class="st">"colToColMat"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/standardGeneric.html">standardGeneric</a></span><span class="op">(</span><span class="st">"colToColMat"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "colToColMat"</code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @export</span>
<span class="kw"><a href="https://rdrr.io/r/methods/setGeneric.html">setGeneric</a></span><span class="op">(</span><span class="st">"rowToColMat"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/standardGeneric.html">standardGeneric</a></span><span class="op">(</span><span class="st">"rowToColMat"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "rowToColMat"</code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @export</span>
<span class="kw"><a href="https://rdrr.io/r/methods/setGeneric.html">setGeneric</a></span><span class="op">(</span><span class="st">"colToRowMat"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/standardGeneric.html">standardGeneric</a></span><span class="op">(</span><span class="st">"colToRowMat"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "colToRowMat"</code></pre>
<p>Again, we define class-specific methods for these generics.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @export</span>
<span class="kw"><a href="https://rdrr.io/r/methods/setMethod.html">setMethod</a></span><span class="op">(</span><span class="st">"rowToRowMat"</span>, <span class="st">"ExampleClass"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">withDimnames</span><span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">out</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">@</span><span class="va">rowToRowMat</span>
    <span class="kw">if</span> <span class="op">(</span><span class="va">withDimnames</span><span class="op">)</span> 
        <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">rownames</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">rownames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
    <span class="va">out</span>
<span class="op">}</span><span class="op">)</span>

<span class="co">#' @export</span>
<span class="kw"><a href="https://rdrr.io/r/methods/setMethod.html">setMethod</a></span><span class="op">(</span><span class="st">"colToColMat"</span>, <span class="st">"ExampleClass"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">withDimnames</span><span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">out</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">@</span><span class="va">colToColMat</span>
    <span class="kw">if</span> <span class="op">(</span><span class="va">withDimnames</span><span class="op">)</span> 
        <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">colnames</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">colnames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
    <span class="va">out</span>
<span class="op">}</span><span class="op">)</span>

<span class="co">#' @export</span>
<span class="kw"><a href="https://rdrr.io/r/methods/setMethod.html">setMethod</a></span><span class="op">(</span><span class="st">"rowToColMat"</span>, <span class="st">"ExampleClass"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">withDimnames</span><span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">out</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">@</span><span class="va">rowToColMat</span>
    <span class="kw">if</span> <span class="op">(</span><span class="va">withDimnames</span><span class="op">)</span> 
        <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">rownames</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">colnames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
    <span class="va">out</span>
<span class="op">}</span><span class="op">)</span>

<span class="co">#' @export</span>
<span class="kw"><a href="https://rdrr.io/r/methods/setMethod.html">setMethod</a></span><span class="op">(</span><span class="st">"colToRowMat"</span>, <span class="st">"ExampleClass"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">withDimnames</span><span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">out</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">@</span><span class="va">colToRowMat</span>
    <span class="kw">if</span> <span class="op">(</span><span class="va">withDimnames</span><span class="op">)</span> 
        <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">colnames</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">rownames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
    <span class="va">out</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
<div id="for-summarizedexperiment-slots" class="section level3">
<h3 class="hasAnchor">
<a href="#for-summarizedexperiment-slots" class="anchor"></a>For <code>SummarizedExperiment</code> slots</h3>
<p>The getter methods defined in <a href="https://bioconductor.org/packages/SummarizedExperiment">SummarizedExperiment</a> can be directly used to retrieve data from slots in the base class. These should generally not require any re-defining for a derived class. However, if it is necessary, the methods should use <code>callNextMethod</code> internally. This will call the method for the base <code>SummarizedExperiment</code> class, the output of which can be modified as required.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @export</span>
<span class="co">#' @importMethodsFrom SummarizedExperiment rowData</span>
<span class="kw"><a href="https://rdrr.io/r/methods/setMethod.html">setMethod</a></span><span class="op">(</span><span class="st">"rowData"</span>, <span class="st">"ExampleClass"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/NextMethod.html">callNextMethod</a></span><span class="op">(</span><span class="op">)</span>
    
    <span class="co"># Do something extra here.</span>
    <span class="va">out</span><span class="op">$</span><span class="va">extra</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">nrow</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span><span class="op">)</span>

    <span class="co"># Returning the rowData object.</span>
    <span class="va">out</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="defining-the-validity-method" class="section level2">
<h2 class="hasAnchor">
<a href="#defining-the-validity-method" class="anchor"></a>Defining the validity method</h2>
<p>We use <code>setValidity2</code> to define a validity function for <code>ExampleClass</code>. We use the previously defined getter functions to retrieve the slot values rather than using <code>@</code>. This is generally a good idea to keep the interface separate from the implementation<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a>. We also set <code>withDimnames=FALSE</code> in our getter calls, as consistent naming is not necessary for internal functions.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @importFrom BiocGenerics NCOL NROW</span>
<span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/S4Vectors-internals.html">setValidity2</a></span><span class="op">(</span><span class="st">"ExampleClass"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">NR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">NROW</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span>
    <span class="va">NC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">NCOL</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span>
    <span class="va">msg</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>

    <span class="co"># 1D</span>
    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu">rowVec</span><span class="op">(</span><span class="va">object</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">!=</span> <span class="va">NR</span><span class="op">)</span> <span class="op">{</span>
        <span class="va">msg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="va">msg</span>, <span class="st">"'rowVec' should have length equal to the number of rows"</span><span class="op">)</span>
    <span class="op">}</span>
    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu">colVec</span><span class="op">(</span><span class="va">object</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">!=</span> <span class="va">NC</span><span class="op">)</span> <span class="op">{</span>
        <span class="va">msg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span>
            <span class="va">msg</span>, <span class="st">"'colVec' should have length equal to the number of columns"</span>
        <span class="op">)</span>
    <span class="op">}</span>

    <span class="co"># 2D</span>
    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">NROW</a></span><span class="op">(</span><span class="fu">rowToRowMat</span><span class="op">(</span><span class="va">object</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">!=</span> <span class="va">NR</span><span class="op">)</span> <span class="op">{</span>
        <span class="va">msg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span>
            <span class="va">msg</span>, <span class="st">"'nrow(rowToRowMat)' should be equal to the number of rows"</span>
        <span class="op">)</span>
    <span class="op">}</span>
    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">NCOL</a></span><span class="op">(</span><span class="fu">colToColMat</span><span class="op">(</span><span class="va">object</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">!=</span> <span class="va">NC</span><span class="op">)</span> <span class="op">{</span>
        <span class="va">msg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span>
            <span class="va">msg</span>, <span class="st">"'ncol(colToColMat)' should be equal to the number of columns"</span>
        <span class="op">)</span>
    <span class="op">}</span>
    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">NROW</a></span><span class="op">(</span><span class="fu">rowToColMat</span><span class="op">(</span><span class="va">object</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">!=</span> <span class="va">NC</span><span class="op">)</span> <span class="op">{</span>
        <span class="va">msg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span>
            <span class="va">msg</span>, <span class="st">"'nrow(rowToColMat)' should be equal to the number of columns"</span>
        <span class="op">)</span>
    <span class="op">}</span>
    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">NCOL</a></span><span class="op">(</span><span class="fu">colToRowMat</span><span class="op">(</span><span class="va">object</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">!=</span> <span class="va">NR</span><span class="op">)</span> <span class="op">{</span>
        <span class="va">msg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span>
            <span class="va">msg</span>, <span class="st">"'ncol(colToRowMat)' should be equal to the number of rows"</span>
        <span class="op">)</span>
    <span class="op">}</span>

    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">msg</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
        <span class="va">msg</span>
    <span class="op">}</span> <span class="kw">else</span> <span class="cn">TRUE</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
<pre><code>## Class "ExampleClass" [in ".GlobalEnv"]
## 
## Slots:
##                                                                               
## Name:             rowVec            colVec       rowToRowMat       colToColMat
## Class:           integer           integer            matrix            matrix
##                                                                               
## Name:        rowToColMat       colToRowMat           colData            assays
## Class:            matrix            matrix         DataFrame    Assays_OR_NULL
##                                                             
## Name:              NAMES   elementMetadata          metadata
## Class: character_OR_NULL         DataFrame              list
## 
## Extends: 
## Class "SummarizedExperiment", directly
## Class "RectangularData", by class "SummarizedExperiment", distance 2
## Class "Vector", by class "SummarizedExperiment", distance 2
## Class "Annotated", by class "SummarizedExperiment", distance 3
## Class "vector_OR_Vector", by class "SummarizedExperiment", distance 3</code></pre>
<p>We use the <code>NCOL</code> and <code>NROW</code> methods from <a href="https://bioconductor.org/packages/BiocGenerics">BiocGenerics</a> as these support various Bioconductor objects, whereas the base methods do not.</p>
</div>
<div id="creating-a-show-method" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-a-show-method" class="anchor"></a>Creating a <code>show</code> method</h2>
<p>The default <code>show</code> method will only display information about the <code>SummarizedExperiment</code> slots. We can augment it to display some relevant aspects of the custom slots. This is done by calling the base <code>show</code> method before printing additional fields as necessary.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @export</span>
<span class="co">#' @importMethodsFrom SummarizedExperiment show</span>
<span class="kw"><a href="https://rdrr.io/r/methods/setMethod.html">setMethod</a></span><span class="op">(</span><span class="st">"show"</span>, <span class="st">"ExampleClass"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/methods/NextMethod.html">callNextMethod</a></span><span class="op">(</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span>
        <span class="st">"rowToRowMat has "</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">ncol</a></span><span class="op">(</span><span class="fu">rowToRowMat</span><span class="op">(</span><span class="va">object</span><span class="op">)</span><span class="op">)</span>, <span class="st">" columns\n"</span>,
        <span class="st">"colToColMat has "</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">nrow</a></span><span class="op">(</span><span class="fu">colToColMat</span><span class="op">(</span><span class="va">object</span><span class="op">)</span><span class="op">)</span>, <span class="st">" rows\n"</span>,
        <span class="st">"rowToColMat has "</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">ncol</a></span><span class="op">(</span><span class="fu">rowToRowMat</span><span class="op">(</span><span class="va">object</span><span class="op">)</span><span class="op">)</span>, <span class="st">" columns\n"</span>,
        <span class="st">"colToRowMat has "</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">ncol</a></span><span class="op">(</span><span class="fu">rowToRowMat</span><span class="op">(</span><span class="va">object</span><span class="op">)</span><span class="op">)</span>, <span class="st">" rows\n"</span>,
        sep<span class="op">=</span><span class="st">""</span>
    <span class="op">)</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
<div id="creating-setter-methods" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-setter-methods" class="anchor"></a>Creating setter methods</h2>
<div id="for-1d-data-structures-1" class="section level3">
<h3 class="hasAnchor">
<a href="#for-1d-data-structures-1" class="anchor"></a>For 1D data structures</h3>
<p>We define some setter methods for the custom slots containing the 1D structures. Again, this usually requires the creation of new generics.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @export</span>
<span class="kw"><a href="https://rdrr.io/r/methods/setGeneric.html">setGeneric</a></span><span class="op">(</span><span class="st">"rowVec&lt;-"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, <span class="va">value</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/standardGeneric.html">standardGeneric</a></span><span class="op">(</span><span class="st">"rowVec&lt;-"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "rowVec&lt;-"</code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @export</span>
<span class="kw"><a href="https://rdrr.io/r/methods/setGeneric.html">setGeneric</a></span><span class="op">(</span><span class="st">"colVec&lt;-"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, <span class="va">value</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/standardGeneric.html">standardGeneric</a></span><span class="op">(</span><span class="st">"colVec&lt;-"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "colVec&lt;-"</code></pre>
<p>We define the class-specific methods for these generics. Note that use of <code>validObject</code> to ensure that the assigned input is still valid.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @export</span>
<span class="fu"><a href="https://rdrr.io/r/methods/GenericFunctions.html">setReplaceMethod</a></span><span class="op">(</span><span class="st">"rowVec"</span>, <span class="st">"ExampleClass"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">value</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">x</span><span class="op">@</span><span class="va">rowVec</span> <span class="op">&lt;-</span> <span class="va">value</span>
    <span class="fu"><a href="https://rdrr.io/r/methods/validObject.html">validObject</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
    <span class="va">x</span>
<span class="op">}</span><span class="op">)</span>

<span class="co">#' @export</span>
<span class="fu"><a href="https://rdrr.io/r/methods/GenericFunctions.html">setReplaceMethod</a></span><span class="op">(</span><span class="st">"colVec"</span>, <span class="st">"ExampleClass"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">value</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">x</span><span class="op">@</span><span class="va">colVec</span> <span class="op">&lt;-</span> <span class="va">value</span>
    <span class="fu"><a href="https://rdrr.io/r/methods/validObject.html">validObject</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
    <span class="va">x</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
<div id="for-2d-data-structures-1" class="section level3">
<h3 class="hasAnchor">
<a href="#for-2d-data-structures-1" class="anchor"></a>For 2D data structures</h3>
<p>We repeat this process for the 2D structures.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @export</span>
<span class="kw"><a href="https://rdrr.io/r/methods/setGeneric.html">setGeneric</a></span><span class="op">(</span><span class="st">"rowToRowMat&lt;-"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, <span class="va">value</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/standardGeneric.html">standardGeneric</a></span><span class="op">(</span><span class="st">"rowToRowMat&lt;-"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<pre><code>## [1] "rowToRowMat&lt;-"</code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @export</span>
<span class="kw"><a href="https://rdrr.io/r/methods/setGeneric.html">setGeneric</a></span><span class="op">(</span><span class="st">"colToColMat&lt;-"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, <span class="va">value</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/standardGeneric.html">standardGeneric</a></span><span class="op">(</span><span class="st">"colToColMat&lt;-"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<pre><code>## [1] "colToColMat&lt;-"</code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @export</span>
<span class="kw"><a href="https://rdrr.io/r/methods/setGeneric.html">setGeneric</a></span><span class="op">(</span><span class="st">"rowToColMat&lt;-"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, <span class="va">value</span><span class="op">)</span> 
    <span class="fu"><a href="https://rdrr.io/r/base/standardGeneric.html">standardGeneric</a></span><span class="op">(</span><span class="st">"rowToColMat&lt;-"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<pre><code>## [1] "rowToColMat&lt;-"</code></pre>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @export</span>
<span class="kw"><a href="https://rdrr.io/r/methods/setGeneric.html">setGeneric</a></span><span class="op">(</span><span class="st">"colToRowMat&lt;-"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, <span class="va">value</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/standardGeneric.html">standardGeneric</a></span><span class="op">(</span><span class="st">"colToRowMat&lt;-"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<pre><code>## [1] "colToRowMat&lt;-"</code></pre>
<p>Again, we define class-specific methods for these generics.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @export</span>
<span class="fu"><a href="https://rdrr.io/r/methods/GenericFunctions.html">setReplaceMethod</a></span><span class="op">(</span><span class="st">"rowToRowMat"</span>, <span class="st">"ExampleClass"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">value</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">x</span><span class="op">@</span><span class="va">rowToRowMat</span> <span class="op">&lt;-</span> <span class="va">value</span>
    <span class="fu"><a href="https://rdrr.io/r/methods/validObject.html">validObject</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
    <span class="va">x</span>
<span class="op">}</span><span class="op">)</span>

<span class="co">#' @export</span>
<span class="fu"><a href="https://rdrr.io/r/methods/GenericFunctions.html">setReplaceMethod</a></span><span class="op">(</span><span class="st">"colToColMat"</span>, <span class="st">"ExampleClass"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">value</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">x</span><span class="op">@</span><span class="va">colToColMat</span> <span class="op">&lt;-</span> <span class="va">value</span>
    <span class="fu"><a href="https://rdrr.io/r/methods/validObject.html">validObject</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
    <span class="va">x</span>
<span class="op">}</span><span class="op">)</span>

<span class="co">#' @export</span>
<span class="fu"><a href="https://rdrr.io/r/methods/GenericFunctions.html">setReplaceMethod</a></span><span class="op">(</span><span class="st">"rowToColMat"</span>, <span class="st">"ExampleClass"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">value</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">x</span><span class="op">@</span><span class="va">rowToColMat</span> <span class="op">&lt;-</span> <span class="va">value</span>
    <span class="fu"><a href="https://rdrr.io/r/methods/validObject.html">validObject</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
    <span class="va">x</span>
<span class="op">}</span><span class="op">)</span>

<span class="co">#' @export</span>
<span class="fu"><a href="https://rdrr.io/r/methods/GenericFunctions.html">setReplaceMethod</a></span><span class="op">(</span><span class="st">"colToRowMat"</span>, <span class="st">"ExampleClass"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">value</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">x</span><span class="op">@</span><span class="va">colToRowMat</span> <span class="op">&lt;-</span> <span class="va">value</span>
    <span class="fu"><a href="https://rdrr.io/r/methods/validObject.html">validObject</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
    <span class="va">x</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
<div id="for-summarizedexperiment-slots-1" class="section level3">
<h3 class="hasAnchor">
<a href="#for-summarizedexperiment-slots-1" class="anchor"></a>For <code>SummarizedExperiment</code> slots</h3>
<p>Again, we can use the setter methods defined in <a href="https://bioconductor.org/packages/SummarizedExperiment">SummarizedExperiment</a> to modify slots in the base class. These should generally not require any re-defining. However, if it is necessary, the methods should use <code>callNextMethod</code> internally:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @export</span>
<span class="co">#' @importMethodsFrom SummarizedExperiment "rowData&lt;-"</span>
<span class="fu"><a href="https://rdrr.io/r/methods/GenericFunctions.html">setReplaceMethod</a></span><span class="op">(</span><span class="st">"rowData"</span>, <span class="st">"ExampleClass"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, <span class="va">value</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/NextMethod.html">callNextMethod</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># returns a modified ExampleClass</span>
    
    <span class="co"># Do something extra here.</span>
    <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"hi!\n"</span><span class="op">)</span>

    <span class="va">y</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
<div id="other-types-of-modifying-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#other-types-of-modifying-functions" class="anchor"></a>Other types of modifying functions</h3>
<p>Imagine that we want to write a function that returns a modified <code>ExampleClass</code>, e.g., where the signs of the <code>*.vec</code> fields are reversed. For example, we will pretend that we want to write a <code>normalize</code> function, using the generic from <a href="https://bioconductor.org/packages/BiocGenerics">BiocGenerics</a>.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @export</span>
<span class="co">#' @importFrom BiocGenerics normalize</span>
<span class="kw"><a href="https://rdrr.io/r/methods/setMethod.html">setMethod</a></span><span class="op">(</span><span class="st">"normalize"</span>, <span class="st">"ExampleClass"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">{</span>
    <span class="co"># do something exciting, i.e., flip the signs</span>
    <span class="va">new.row</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu">rowVec</span><span class="op">(</span><span class="va">object</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> 
    <span class="va">new.col</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu">colVec</span><span class="op">(</span><span class="va">object</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
    <span class="fu">BiocGenerics</span><span class="fu">:::</span><span class="fu">replaceSlots</span><span class="op">(</span><span class="va">object</span>, rowVec<span class="op">=</span><span class="va">new.row</span>, 
        colVec<span class="op">=</span><span class="va">new.col</span>, check<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
<p>We use <code>BiocGenerics:::replaceSlots</code> instead of the setter methods that we defined above. This is because our setters perform validity checks that are unnecessary if we know that the modification cannot alter the validity of the object. The <code>replaceSlots</code> function allows us to skip these validity checks (<code>check=FALSE</code>) for greater efficiency.</p>
</div>
</div>
<div id="enabling-subsetting-operations" class="section level2">
<h2 class="hasAnchor">
<a href="#enabling-subsetting-operations" class="anchor"></a>Enabling subsetting operations</h2>
<div id="getting-a-subset" class="section level3">
<h3 class="hasAnchor">
<a href="#getting-a-subset" class="anchor"></a>Getting a subset</h3>
<p>A key strength of the <code>SummarizedExperiment</code> class is that subsetting is synchronized across the various (meta)data fields. This avoids book-keeping errors and guarantees consistency throughout an interactive analysis session. We need to ensure that the values in our custom slots are also subsetted.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @export</span>
<span class="kw"><a href="https://rdrr.io/r/methods/setMethod.html">setMethod</a></span><span class="op">(</span><span class="st">"["</span>, <span class="st">"ExampleClass"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">i</span>, <span class="va">j</span>, <span class="va">drop</span><span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">rv</span> <span class="op">&lt;-</span> <span class="fu">rowVec</span><span class="op">(</span><span class="va">x</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
    <span class="va">cv</span> <span class="op">&lt;-</span> <span class="fu">colVec</span><span class="op">(</span><span class="va">x</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
    <span class="va">rrm</span> <span class="op">&lt;-</span> <span class="fu">rowToRowMat</span><span class="op">(</span><span class="va">x</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
    <span class="va">ccm</span> <span class="op">&lt;-</span> <span class="fu">colToColMat</span><span class="op">(</span><span class="va">x</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
    <span class="va">rcm</span> <span class="op">&lt;-</span> <span class="fu">rowToColMat</span><span class="op">(</span><span class="va">x</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
    <span class="va">crm</span> <span class="op">&lt;-</span> <span class="fu">colToRowMat</span><span class="op">(</span><span class="va">x</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>

    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/missing.html">missing</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
        <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">is.character</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
            <span class="va">fmt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"&lt;"</span>, <span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="st">"&gt;[i,] index out of bounds: %s"</span><span class="op">)</span>
            <span class="va">i</span> <span class="op">&lt;-</span> <span class="fu">SummarizedExperimentGHA</span><span class="fu">:::</span><span class="fu">.SummarizedExperiment.charbound</span><span class="op">(</span>
                <span class="va">i</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">rownames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="va">fmt</span>
            <span class="op">)</span>
        <span class="op">}</span>
        <span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.vector.html">as.vector</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span>
        <span class="va">rv</span> <span class="op">&lt;-</span> <span class="va">rv</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
        <span class="va">rrm</span> <span class="op">&lt;-</span> <span class="va">rrm</span><span class="op">[</span><span class="va">i</span>,,drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>
        <span class="va">crm</span> <span class="op">&lt;-</span> <span class="va">crm</span><span class="op">[</span>,<span class="va">i</span>,drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>
    <span class="op">}</span>

    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/missing.html">missing</a></span><span class="op">(</span><span class="va">j</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
        <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">is.character</a></span><span class="op">(</span><span class="va">j</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
            <span class="va">fmt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"&lt;"</span>, <span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="st">"&gt;[,j] index out of bounds: %s"</span><span class="op">)</span>
            <span class="va">j</span> <span class="op">&lt;-</span> <span class="fu">SummarizedExperimentGHA</span><span class="fu">:::</span><span class="fu">.SummarizedExperiment.charbound</span><span class="op">(</span>
                <span class="va">j</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">colnames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="va">fmt</span>
            <span class="op">)</span>
        <span class="op">}</span>
        <span class="va">j</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.vector.html">as.vector</a></span><span class="op">(</span><span class="va">j</span><span class="op">)</span>
        <span class="va">cv</span> <span class="op">&lt;-</span> <span class="va">cv</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>
        <span class="va">ccm</span> <span class="op">&lt;-</span> <span class="va">ccm</span><span class="op">[</span>,<span class="va">j</span>,drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>
        <span class="va">rcm</span> <span class="op">&lt;-</span> <span class="va">rcm</span><span class="op">[</span><span class="va">j</span>,,drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>
    <span class="op">}</span>

    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/NextMethod.html">callNextMethod</a></span><span class="op">(</span><span class="op">)</span>
    <span class="fu">BiocGenerics</span><span class="fu">:::</span><span class="fu">replaceSlots</span><span class="op">(</span><span class="va">out</span>, rowVec<span class="op">=</span><span class="va">rv</span>, colVec<span class="op">=</span><span class="va">cv</span>,
        rowToRowMat<span class="op">=</span><span class="va">rrm</span>, colToColMat<span class="op">=</span><span class="va">ccm</span>, 
        rowToColMat<span class="op">=</span><span class="va">rcm</span>, colToRowMat<span class="op">=</span><span class="va">crm</span>, check<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
<p>Note the special code for handling character indices, and the use of <code>callNextMethod</code> to subset the base <code>SummarizedExperiment</code> slots.</p>
</div>
<div id="assigning-a-subset" class="section level3">
<h3 class="hasAnchor">
<a href="#assigning-a-subset" class="anchor"></a>Assigning a subset</h3>
<p>Subset assignment can be similarly performed, though the signature needs to be specified so that the replacement value is of the same class. This is generally necessary for sensible replacement of the custom slots.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @export</span>
<span class="fu"><a href="https://rdrr.io/r/methods/GenericFunctions.html">setReplaceMethod</a></span><span class="op">(</span><span class="st">"["</span>, <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="st">"ExampleClass"</span>, <span class="st">"ANY"</span>, <span class="st">"ANY"</span>, <span class="st">"ExampleClass"</span><span class="op">)</span>,
        <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">i</span>, <span class="va">j</span>, <span class="va">...</span>, <span class="va">value</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">rv</span> <span class="op">&lt;-</span> <span class="fu">rowVec</span><span class="op">(</span><span class="va">x</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
    <span class="va">cv</span> <span class="op">&lt;-</span> <span class="fu">colVec</span><span class="op">(</span><span class="va">x</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
    <span class="va">rrm</span> <span class="op">&lt;-</span> <span class="fu">rowToRowMat</span><span class="op">(</span><span class="va">x</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
    <span class="va">ccm</span> <span class="op">&lt;-</span> <span class="fu">colToColMat</span><span class="op">(</span><span class="va">x</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
    <span class="va">rcm</span> <span class="op">&lt;-</span> <span class="fu">rowToColMat</span><span class="op">(</span><span class="va">x</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
    <span class="va">crm</span> <span class="op">&lt;-</span> <span class="fu">colToRowMat</span><span class="op">(</span><span class="va">x</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>

    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/missing.html">missing</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
        <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">is.character</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
            <span class="va">fmt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"&lt;"</span>, <span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="st">"&gt;[i,] index out of bounds: %s"</span><span class="op">)</span>
            <span class="va">i</span> <span class="op">&lt;-</span> <span class="fu">SummarizedExperimentGHA</span><span class="fu">:::</span><span class="fu">.SummarizedExperiment.charbound</span><span class="op">(</span>
                <span class="va">i</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">rownames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="va">fmt</span>
            <span class="op">)</span>
        <span class="op">}</span>
        <span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.vector.html">as.vector</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span>
        <span class="va">rv</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">rowVec</span><span class="op">(</span><span class="va">value</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
        <span class="va">rrm</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">rowToRowMat</span><span class="op">(</span><span class="va">value</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
        <span class="va">crm</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">colToRowMat</span><span class="op">(</span><span class="va">value</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
    <span class="op">}</span>

    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/missing.html">missing</a></span><span class="op">(</span><span class="va">j</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
        <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">is.character</a></span><span class="op">(</span><span class="va">j</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
            <span class="va">fmt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"&lt;"</span>, <span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="st">"&gt;[,j] index out of bounds: %s"</span><span class="op">)</span>
            <span class="va">j</span> <span class="op">&lt;-</span> <span class="fu">SummarizedExperimentGHA</span><span class="fu">:::</span><span class="fu">.SummarizedExperiment.charbound</span><span class="op">(</span>
                <span class="va">j</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">colnames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="va">fmt</span>
            <span class="op">)</span>
        <span class="op">}</span>
        <span class="va">j</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.vector.html">as.vector</a></span><span class="op">(</span><span class="va">j</span><span class="op">)</span>
        <span class="va">cv</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">colVec</span><span class="op">(</span><span class="va">value</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
        <span class="va">ccm</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">colToColMat</span><span class="op">(</span><span class="va">value</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
        <span class="va">rcm</span><span class="op">[</span><span class="va">j</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">rowToColMat</span><span class="op">(</span><span class="va">value</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
    <span class="op">}</span>

    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/NextMethod.html">callNextMethod</a></span><span class="op">(</span><span class="op">)</span>
    <span class="fu">BiocGenerics</span><span class="fu">:::</span><span class="fu">replaceSlots</span><span class="op">(</span><span class="va">out</span>, rowVec<span class="op">=</span><span class="va">rv</span>, colVec<span class="op">=</span><span class="va">cv</span>,
        rowToRowMat<span class="op">=</span><span class="va">rrm</span>, colToColMat<span class="op">=</span><span class="va">ccm</span>, 
        rowToColMat<span class="op">=</span><span class="va">rcm</span>, colToRowMat<span class="op">=</span><span class="va">crm</span>, check<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="defining-combining-methods" class="section level2">
<h2 class="hasAnchor">
<a href="#defining-combining-methods" class="anchor"></a>Defining combining methods</h2>
<div id="by-row" class="section level3">
<h3 class="hasAnchor">
<a href="#by-row" class="anchor"></a>By row</h3>
<p>We need to define a <code>rbind</code> method for our custom class. This is done by combining the custom per-row slots across class instances.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @export</span>
<span class="kw"><a href="https://rdrr.io/r/methods/setMethod.html">setMethod</a></span><span class="op">(</span><span class="st">"rbind"</span>, <span class="st">"ExampleClass"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">...</span>, <span class="va">deparse.level</span><span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">args</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span>
    <span class="va">all.rv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html">lapply</a></span><span class="op">(</span><span class="va">args</span>, <span class="va">rowVec</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
    <span class="va">all.rrm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html">lapply</a></span><span class="op">(</span><span class="va">args</span>, <span class="va">rowToRowMat</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
    <span class="va">all.crm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html">lapply</a></span><span class="op">(</span><span class="va">args</span>, <span class="va">colToRowMat</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>

    <span class="va">all.rv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/do.call.html">do.call</a></span><span class="op">(</span><span class="va">c</span>, <span class="va">all.rv</span><span class="op">)</span>
    <span class="va">all.rrm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">all.rrm</span><span class="op">)</span>
    <span class="va">all.crm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/do.call.html">do.call</a></span><span class="op">(</span><span class="va">cbind</span>, <span class="va">all.crm</span><span class="op">)</span>

    <span class="co"># Checks for identical column state.</span>
    <span class="va">ref</span> <span class="op">&lt;-</span> <span class="va">args</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
    <span class="va">ref.cv</span> <span class="op">&lt;-</span> <span class="fu">colVec</span><span class="op">(</span><span class="va">ref</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
    <span class="va">ref.ccm</span> <span class="op">&lt;-</span> <span class="fu">colToColMat</span><span class="op">(</span><span class="va">ref</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
    <span class="va">ref.rcm</span> <span class="op">&lt;-</span> <span class="fu">rowToColMat</span><span class="op">(</span><span class="va">ref</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
    <span class="kw">for</span> <span class="op">(</span><span class="va">x</span> <span class="kw">in</span> <span class="va">args</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span>
        <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span><span class="op">(</span><span class="va">ref.cv</span>, <span class="fu">colVec</span><span class="op">(</span><span class="va">x</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> 
            <span class="op">||</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span><span class="op">(</span><span class="va">ref.ccm</span>, <span class="fu">colToColMat</span><span class="op">(</span><span class="va">x</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>
            <span class="op">||</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span><span class="op">(</span><span class="va">ref.rcm</span>, <span class="fu">rowToColMat</span><span class="op">(</span><span class="va">x</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
        <span class="op">{</span>
            <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="st">"per-column values are not compatible"</span><span class="op">)</span>
        <span class="op">}</span>
    <span class="op">}</span>
 
    <span class="va">old.validity</span> <span class="op">&lt;-</span> <span class="fu">S4Vectors</span><span class="fu">:::</span><span class="fu">disableValidity</span><span class="op">(</span><span class="op">)</span>
    <span class="fu">S4Vectors</span><span class="fu">:::</span><span class="fu">disableValidity</span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/on.exit.html">on.exit</a></span><span class="op">(</span><span class="fu">S4Vectors</span><span class="fu">:::</span><span class="fu">disableValidity</span><span class="op">(</span><span class="va">old.validity</span><span class="op">)</span><span class="op">)</span>

    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/NextMethod.html">callNextMethod</a></span><span class="op">(</span><span class="op">)</span>
    <span class="fu">BiocGenerics</span><span class="fu">:::</span><span class="fu">replaceSlots</span><span class="op">(</span><span class="va">out</span>, rowVec<span class="op">=</span><span class="va">all.rv</span>,
        rowToRowMat<span class="op">=</span><span class="va">all.rrm</span>, colToRowMat<span class="op">=</span><span class="va">all.crm</span>, 
        check<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
<p>We check the other per-column slots across all elements to ensure that they are the same. This protects the user against combining incompatible objects. However, depending on the application, this may not be necessary (or too costly) for all slots, in which case it can be limited to critical slots.</p>
<p>We also use the <code>disableValidity</code> method to avoid the validity check in the base <code>cbind</code> method. This is because the object is technically invalid when the base slots are combined but before it is updated with the new combined values for the custom slots. The <code>on.exit</code> call ensures that the original validity setting is restored upon exit of the function.</p>
</div>
<div id="by-column" class="section level3">
<h3 class="hasAnchor">
<a href="#by-column" class="anchor"></a>By column</h3>
<p>We similarly define a <code>cbind</code> method to handle the custom slots.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @export</span>
<span class="kw"><a href="https://rdrr.io/r/methods/setMethod.html">setMethod</a></span><span class="op">(</span><span class="st">"cbind"</span>, <span class="st">"ExampleClass"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">...</span>, <span class="va">deparse.level</span><span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">args</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span>
    <span class="va">all.cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html">lapply</a></span><span class="op">(</span><span class="va">args</span>, <span class="va">colVec</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
    <span class="va">all.ccm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html">lapply</a></span><span class="op">(</span><span class="va">args</span>, <span class="va">colToColMat</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
    <span class="va">all.rcm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html">lapply</a></span><span class="op">(</span><span class="va">args</span>, <span class="va">rowToColMat</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>

    <span class="va">all.cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/do.call.html">do.call</a></span><span class="op">(</span><span class="va">c</span>, <span class="va">all.cv</span><span class="op">)</span>
    <span class="va">all.ccm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/do.call.html">do.call</a></span><span class="op">(</span><span class="va">cbind</span>, <span class="va">all.ccm</span><span class="op">)</span>
    <span class="va">all.rcm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">all.rcm</span><span class="op">)</span>

    <span class="co"># Checks for identical column state.</span>
    <span class="va">ref</span> <span class="op">&lt;-</span> <span class="va">args</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
    <span class="va">ref.rv</span> <span class="op">&lt;-</span> <span class="fu">rowVec</span><span class="op">(</span><span class="va">ref</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
    <span class="va">ref.rrm</span> <span class="op">&lt;-</span> <span class="fu">rowToRowMat</span><span class="op">(</span><span class="va">ref</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
    <span class="va">ref.crm</span> <span class="op">&lt;-</span> <span class="fu">colToRowMat</span><span class="op">(</span><span class="va">ref</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
    <span class="kw">for</span> <span class="op">(</span><span class="va">x</span> <span class="kw">in</span> <span class="va">args</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span>
        <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span><span class="op">(</span><span class="va">ref.rv</span>, <span class="fu">rowVec</span><span class="op">(</span><span class="va">x</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> 
            <span class="op">||</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span><span class="op">(</span><span class="va">ref.rrm</span>, <span class="fu">rowToRowMat</span><span class="op">(</span><span class="va">x</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>
            <span class="op">||</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span><span class="op">(</span><span class="va">ref.crm</span>, <span class="fu">colToRowMat</span><span class="op">(</span><span class="va">x</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
        <span class="op">{</span>
            <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="st">"per-row values are not compatible"</span><span class="op">)</span>
        <span class="op">}</span>
    <span class="op">}</span>

    <span class="va">old.validity</span> <span class="op">&lt;-</span> <span class="fu">S4Vectors</span><span class="fu">:::</span><span class="fu">disableValidity</span><span class="op">(</span><span class="op">)</span>
    <span class="fu">S4Vectors</span><span class="fu">:::</span><span class="fu">disableValidity</span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/on.exit.html">on.exit</a></span><span class="op">(</span><span class="fu">S4Vectors</span><span class="fu">:::</span><span class="fu">disableValidity</span><span class="op">(</span><span class="va">old.validity</span><span class="op">)</span><span class="op">)</span>

    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/NextMethod.html">callNextMethod</a></span><span class="op">(</span><span class="op">)</span>
    <span class="fu">BiocGenerics</span><span class="fu">:::</span><span class="fu">replaceSlots</span><span class="op">(</span><span class="va">out</span>, colVec<span class="op">=</span><span class="va">all.cv</span>,
        colToColMat<span class="op">=</span><span class="va">all.ccm</span>, rowToColMat<span class="op">=</span><span class="va">all.rcm</span>, 
        check<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="defining-coercion-methods" class="section level2">
<h2 class="hasAnchor">
<a href="#defining-coercion-methods" class="anchor"></a>Defining coercion methods</h2>
<div id="coercion-from-summarizedexperiment" class="section level3">
<h3 class="hasAnchor">
<a href="#coercion-from-summarizedexperiment" class="anchor"></a>Coercion from <code>SummarizedExperiment</code>
</h3>
<p>We define a method to coerce <code>SummarizedExperiment</code> objects into our new <code>ExampleClass</code> class.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @exportMethods coerce</span>
<span class="fu"><a href="https://rdrr.io/r/methods/setAs.html">setAs</a></span><span class="op">(</span><span class="st">"SummarizedExperiment"</span>, <span class="st">"ExampleClass"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">from</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/methods/new.html">new</a></span><span class="op">(</span><span class="st">"ExampleClass"</span>, <span class="va">from</span>, 
        rowVec<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html">integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">nrow</a></span><span class="op">(</span><span class="va">from</span><span class="op">)</span><span class="op">)</span>, 
        colVec<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html">integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">ncol</a></span><span class="op">(</span><span class="va">from</span><span class="op">)</span><span class="op">)</span>,
        rowToRowMat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">nrow</a></span><span class="op">(</span><span class="va">from</span><span class="op">)</span>,<span class="fl">0</span><span class="op">)</span>,
        colToColMat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">ncol</a></span><span class="op">(</span><span class="va">from</span><span class="op">)</span><span class="op">)</span>,
        rowToColMat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">ncol</a></span><span class="op">(</span><span class="va">from</span><span class="op">)</span>,<span class="fl">0</span><span class="op">)</span>,
        colToRowMat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">nrow</a></span><span class="op">(</span><span class="va">from</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
<p>… which works as expected:</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RangedSummarizedExperiment-class.html">SummarizedExperiment</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="fl">100</span>, lambda<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/methods/as.html">as</a></span><span class="op">(</span><span class="va">se</span>, <span class="st">"CountSE"</span><span class="op">)</span></code></pre></div>
<pre><code>## class: CountSE 
## dim: 20 5 
## metadata(0):
## assays(1): ''
## rownames: NULL
## rowData names(0):
## colnames: NULL
## colData names(0):</code></pre>
<p>This was not strictly necessary for our previous <code>CountSE</code> class as no new slots were added. Of course, developers can still explicitly write a conversion method perform additional work to achieve a “sensible” conversion - for example, one might take the absolute values of all entries of the first matrix to ensure that the <code>CountSE</code> is valid for all input <code>SummarizedExperiment</code> objects.</p>
</div>
<div id="deriving-from-a-rangedsummarizedexperiment" class="section level3">
<h3 class="hasAnchor">
<a href="#deriving-from-a-rangedsummarizedexperiment" class="anchor"></a>Deriving from a <code>RangedSummarizedExperiment</code>
</h3>
<p>Note that, if we were deriving from a <code>RangedSummarizedExperiment</code> (e.g., for some <code>ExampleClassRanged</code>), it would be necessary to define explicit conversions from both <code>RangedSummarizedExperiment</code> <em>and</em> <code>SummarizedExperment</code> to <code>ExampleClassRanged</code>. In theory, we should only have to define a conversion from <code>RangedSummarizedExperiment</code> to <code>ExampleClassRanged</code> - then, any attempt to convert from a <code>SummarizedExperiment</code> to <code>ExampleClassRanged</code> would:</p>
<ol style="list-style-type: decimal">
<li>Use the existing <code>SummarizedExperiment</code> to <code>RangedSummarizedExperiment</code> converter defined in <em><a href="https://bioconductor.org/packages/3.13/SummarizedExperiment">SummarizedExperiment</a></em>, and then</li>
<li>Use the new <code>RangedSummarizedExperiment</code> to <code>ExampleClassRanged</code> converter that we just defined.</li>
</ol>
<p>Unfortunately, in cases involving conversion to non-direct subclasses, the S4 system automatically creates methods for any conversions that are not explicitly defined. This means that the correct “chain” of methods listed above is not used when converting from a <code>SummarizedExperiment</code> to a <code>ExampleClassRanged</code> object. The automatically generated method is used instead, which may not yield a valid object when the specifics of the conversion are ignored. We avoid this scenario by explicitly defining converters for both <code>SummarizedExperiment</code> and <code>RangedSummarizedExperiment</code> to <code>ExampleClassRanged</code>.</p>
</div>
</div>
</div>
<div id="unit-testing-procedures" class="section level1">
<h1 class="hasAnchor">
<a href="#unit-testing-procedures" class="anchor"></a>Unit testing procedures</h1>
<div id="overview-1" class="section level2">
<h2 class="hasAnchor">
<a href="#overview-1" class="anchor"></a>Overview</h2>
<p>We test our new methods using the <code>expect_*</code> functions from the <a href="https://cran.r-project.org/package=testthat">testthat</a> package. Each function will test an expression and will raise an error if the output is not as expected. This can be used to construct unit tests for the <code>tests/</code> subdirectory of the package. Unit testing ensures that the methods behave as expected, especially after any refactoring that may be performed in the future.</p>
<p>For testing, we will construct an instance of <code>ExampleClass</code> that has 10 rows and 7 columns:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">RV</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>
<span class="va">CV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">7</span><span class="op">)</span>
<span class="va">RRM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">10</span><span class="op">)</span>
<span class="va">CCM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">14</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">7</span><span class="op">)</span>
<span class="va">RCM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">21</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">7</span><span class="op">)</span>
<span class="va">CRM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">10</span><span class="op">)</span>

<span class="va">thing</span> <span class="op">&lt;-</span> <span class="fu">ExampleClass</span><span class="op">(</span>rowVec<span class="op">=</span><span class="va">RV</span>, colVec<span class="op">=</span><span class="va">CV</span>,
    rowToRowMat<span class="op">=</span><span class="va">RRM</span>, colToColMat<span class="op">=</span><span class="va">CCM</span>,
    rowToColMat<span class="op">=</span><span class="va">RCM</span>, colToRowMat<span class="op">=</span><span class="va">CRM</span>,
    assays<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>counts<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">70</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span>,
    colData<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html">DataFrame</a></span><span class="op">(</span>whee<span class="op">=</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span>,
    rowData<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html">DataFrame</a></span><span class="op">(</span>yay<span class="op">=</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>We will also add some row and column names, which will come in handy later.</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">rownames</a></span><span class="op">(</span><span class="va">thing</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"FEATURE_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">nrow</a></span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">colnames</a></span><span class="op">(</span><span class="va">thing</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"SAMPLE_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">ncol</a></span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">thing</span></code></pre></div>
<pre><code>## class: ExampleClass 
## dim: 10 7 
## metadata(0):
## assays(1): counts
## rownames(10): FEATURE_1 FEATURE_2 ... FEATURE_9 FEATURE_10
## rowData names(2): yay extra
## colnames(7): SAMPLE_1 SAMPLE_2 ... SAMPLE_6 SAMPLE_7
## colData names(1): whee
## rowToRowMat has 3 columns
## colToColMat has 2 rows
## rowToColMat has 3 columns
## colToRowMat has 3 rows</code></pre>
</div>
<div id="constructor" class="section level2">
<h2 class="hasAnchor">
<a href="#constructor" class="anchor"></a>Constructor</h2>
<p>We test that the <code>thing</code> object we constructed is valid:</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">expect_true</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/methods/validObject.html">validObject</a></span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Another useful set of unit tests involves checking that the default constructors (internal and exported) yield valid objects:</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">expect_true</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/methods/validObject.html">validObject</a></span><span class="op">(</span><span class="fu">.ExampleClass</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># internal</span>
<span class="fu">expect_true</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/methods/validObject.html">validObject</a></span><span class="op">(</span><span class="fu">ExampleClass</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># exported</span></code></pre></div>
<p>We can also verify that the validity method fails on invalid objects:</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">expect_error</span><span class="op">(</span><span class="fu">ExampleClass</span><span class="op">(</span>rowVec<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, <span class="st">"rowVec"</span><span class="op">)</span>
<span class="fu">expect_error</span><span class="op">(</span><span class="fu">ExampleClass</span><span class="op">(</span>colVec<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, <span class="st">"colVec"</span><span class="op">)</span>
<span class="fu">expect_error</span><span class="op">(</span><span class="fu">ExampleClass</span><span class="op">(</span>rowToRowMat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/DelayedArray/man/DelayedArray-utils.html">rbind</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="st">"rowToRowMat"</span><span class="op">)</span>
<span class="fu">expect_error</span><span class="op">(</span><span class="fu">ExampleClass</span><span class="op">(</span>colToColMat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/DelayedArray/man/DelayedArray-utils.html">rbind</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="st">"colToColMat"</span><span class="op">)</span>
<span class="fu">expect_error</span><span class="op">(</span><span class="fu">ExampleClass</span><span class="op">(</span>rowToColMat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/DelayedArray/man/DelayedArray-utils.html">rbind</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="st">"rowToColMat"</span><span class="op">)</span>
<span class="fu">expect_error</span><span class="op">(</span><span class="fu">ExampleClass</span><span class="op">(</span>colToRowMat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/DelayedArray/man/DelayedArray-utils.html">rbind</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="st">"colToRowMat"</span><span class="op">)</span></code></pre></div>
<p>Finally, we check that the coercion method yields a valid object.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/as.html">as</a></span><span class="op">(</span><span class="va">thing</span>, <span class="st">"SummarizedExperiment"</span><span class="op">)</span>
<span class="va">conv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/as.html">as</a></span><span class="op">(</span><span class="va">se</span>, <span class="st">"ExampleClass"</span><span class="op">)</span>
<span class="fu">expect_true</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/methods/validObject.html">validObject</a></span><span class="op">(</span><span class="va">conv</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="getters" class="section level2">
<h2 class="hasAnchor">
<a href="#getters" class="anchor"></a>Getters</h2>
<p>Testing the 1D getter methods:</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">expect_identical</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="fu">rowVec</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">rownames</a></span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">)</span>
<span class="fu">expect_identical</span><span class="op">(</span><span class="fu">rowVec</span><span class="op">(</span><span class="va">thing</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>, <span class="va">RV</span><span class="op">)</span>

<span class="fu">expect_identical</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="fu">colVec</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">colnames</a></span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">)</span>
<span class="fu">expect_identical</span><span class="op">(</span><span class="fu">colVec</span><span class="op">(</span><span class="va">thing</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>, <span class="va">CV</span><span class="op">)</span></code></pre></div>
<p>Testing the 2D getter methods:</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">expect_identical</span><span class="op">(</span><span class="fu">rowToRowMat</span><span class="op">(</span><span class="va">thing</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>, <span class="va">RRM</span><span class="op">)</span>
<span class="fu">expect_identical</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">rownames</a></span><span class="op">(</span><span class="fu">rowToRowMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">rownames</a></span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">)</span>

<span class="fu">expect_identical</span><span class="op">(</span><span class="fu">colToColMat</span><span class="op">(</span><span class="va">thing</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>, <span class="va">CCM</span><span class="op">)</span>
<span class="fu">expect_identical</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">colnames</a></span><span class="op">(</span><span class="fu">colToColMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">colnames</a></span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">)</span>

<span class="fu">expect_identical</span><span class="op">(</span><span class="fu">rowToColMat</span><span class="op">(</span><span class="va">thing</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>, <span class="va">RCM</span><span class="op">)</span>
<span class="fu">expect_identical</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">rownames</a></span><span class="op">(</span><span class="fu">rowToColMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">colnames</a></span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">)</span>

<span class="fu">expect_identical</span><span class="op">(</span><span class="fu">colToRowMat</span><span class="op">(</span><span class="va">thing</span>, withDimnames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>, <span class="va">CRM</span><span class="op">)</span>
<span class="fu">expect_identical</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">colnames</a></span><span class="op">(</span><span class="fu">colToRowMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">rownames</a></span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Testing the custom <code>rowData</code> method:</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">expect_true</span><span class="op">(</span><span class="st">"extra"</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">colnames</a></span><span class="op">(</span><span class="fu"><a href="../reference/SummarizedExperiment-class.html">rowData</a></span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="setters" class="section level2">
<h2 class="hasAnchor">
<a href="#setters" class="anchor"></a>Setters</h2>
<p>Testing the 1D setter methods:</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">rowVec</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">9</span>
<span class="fu">expect_equivalent</span><span class="op">(</span><span class="fu">rowVec</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span>, <span class="fl">0</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span>

<span class="fu">colVec</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">7</span><span class="op">:</span><span class="fl">1</span>
<span class="fu">expect_equivalent</span><span class="op">(</span><span class="fu">colVec</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span>, <span class="fl">7</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
<p>Testing the 2D setter methods:</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">old</span> <span class="op">&lt;-</span> <span class="fu">rowToRowMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span>
<span class="fu">rowToRowMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="va">old</span>
<span class="fu">expect_equivalent</span><span class="op">(</span><span class="fu">rowToRowMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span>, <span class="op">-</span><span class="va">old</span><span class="op">)</span>

<span class="va">old</span> <span class="op">&lt;-</span> <span class="fu">colToColMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span>
<span class="fu">colToColMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">old</span>
<span class="fu">expect_equivalent</span><span class="op">(</span><span class="fu">colToColMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span>, <span class="fl">2</span> <span class="op">*</span> <span class="va">old</span><span class="op">)</span>

<span class="va">old</span> <span class="op">&lt;-</span> <span class="fu">rowToColMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span>
<span class="fu">rowToColMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">old</span> <span class="op">+</span> <span class="fl">1</span>
<span class="fu">expect_equivalent</span><span class="op">(</span><span class="fu">rowToColMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span>, <span class="va">old</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>

<span class="va">old</span> <span class="op">&lt;-</span> <span class="fu">colToRowMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span> 
<span class="fu">colToRowMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">old</span> <span class="op">/</span> <span class="fl">10</span>
<span class="fu">expect_equivalent</span><span class="op">(</span><span class="fu">colToRowMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span>, <span class="va">old</span> <span class="op">/</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<p>Testing our custom <code>rowData&lt;-</code> method:</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">expect_message</span><span class="op">(</span><span class="fu"><a href="../reference/SummarizedExperiment-class.html">rowData</a></span><span class="op">(</span><span class="va">thing</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span>, <span class="st">"hi"</span><span class="op">)</span></code></pre></div>
<p>We ensure that we can successfully trigger errors on the validity method:</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">expect_error</span><span class="op">(</span><span class="fu">rowVec</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0</span>, <span class="st">"rowVec"</span><span class="op">)</span>
<span class="fu">expect_error</span><span class="op">(</span><span class="fu">colVec</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0</span>, <span class="st">"colVec"</span><span class="op">)</span>
<span class="fu">expect_error</span><span class="op">(</span><span class="fu">rowToRowMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DelayedArray/man/DelayedArray-utils.html">rbind</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, <span class="st">"rowToRowMat"</span><span class="op">)</span>
<span class="fu">expect_error</span><span class="op">(</span><span class="fu">colToColMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DelayedArray/man/DelayedArray-utils.html">rbind</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, <span class="st">"colToColMat"</span><span class="op">)</span>
<span class="fu">expect_error</span><span class="op">(</span><span class="fu">rowToColMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DelayedArray/man/DelayedArray-utils.html">rbind</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, <span class="st">"rowToColMat"</span><span class="op">)</span>
<span class="fu">expect_error</span><span class="op">(</span><span class="fu">colToRowMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DelayedArray/man/DelayedArray-utils.html">rbind</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, <span class="st">"colToRowMat"</span><span class="op">)</span></code></pre></div>
</div>
<div id="other-modifying-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#other-modifying-functions" class="anchor"></a>Other modifying functions</h2>
<p>We test our new <code>normalize</code> method:</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">modified</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/normalize.html">normalize</a></span><span class="op">(</span><span class="va">thing</span><span class="op">)</span>
<span class="fu">expect_equal</span><span class="op">(</span><span class="fu">rowVec</span><span class="op">(</span><span class="va">modified</span><span class="op">)</span>, <span class="op">-</span><span class="fu">rowVec</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">)</span>
<span class="fu">expect_equal</span><span class="op">(</span><span class="fu">colVec</span><span class="op">(</span><span class="va">modified</span><span class="op">)</span>, <span class="op">-</span><span class="fu">colVec</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="subsetting-methods" class="section level2">
<h2 class="hasAnchor">
<a href="#subsetting-methods" class="anchor"></a>Subsetting methods</h2>
<p>Subsetting by row:</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">subbyrow</span> <span class="op">&lt;-</span> <span class="va">thing</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span>
<span class="fu">expect_identical</span><span class="op">(</span><span class="fu">rowVec</span><span class="op">(</span><span class="va">subbyrow</span><span class="op">)</span>, <span class="fu">rowVec</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span>
<span class="fu">expect_identical</span><span class="op">(</span><span class="fu">rowToRowMat</span><span class="op">(</span><span class="va">subbyrow</span><span class="op">)</span>, <span class="fu">rowToRowMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span><span class="op">)</span>
<span class="fu">expect_identical</span><span class="op">(</span><span class="fu">colToRowMat</span><span class="op">(</span><span class="va">subbyrow</span><span class="op">)</span>, <span class="fu">colToRowMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span>

<span class="co"># columns unaffected...</span>
<span class="fu">expect_identical</span><span class="op">(</span><span class="fu">colVec</span><span class="op">(</span><span class="va">subbyrow</span><span class="op">)</span>, <span class="fu">colVec</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">)</span> 
<span class="fu">expect_identical</span><span class="op">(</span><span class="fu">colToColMat</span><span class="op">(</span><span class="va">subbyrow</span><span class="op">)</span>, <span class="fu">colToColMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">)</span>
<span class="fu">expect_identical</span><span class="op">(</span><span class="fu">rowToColMat</span><span class="op">(</span><span class="va">subbyrow</span><span class="op">)</span>, <span class="fu">rowToColMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Subsetting by column:</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">subbycol</span> <span class="op">&lt;-</span> <span class="va">thing</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>
<span class="fu">expect_identical</span><span class="op">(</span><span class="fu">colVec</span><span class="op">(</span><span class="va">subbycol</span><span class="op">)</span>, <span class="fu">colVec</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>
<span class="fu">expect_identical</span><span class="op">(</span><span class="fu">colToColMat</span><span class="op">(</span><span class="va">subbycol</span><span class="op">)</span>, <span class="fu">colToColMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>
<span class="fu">expect_identical</span><span class="op">(</span><span class="fu">rowToColMat</span><span class="op">(</span><span class="va">subbycol</span><span class="op">)</span>, <span class="fu">rowToColMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="op">]</span><span class="op">)</span>

<span class="co"># rows unaffected...</span>
<span class="fu">expect_identical</span><span class="op">(</span><span class="fu">rowVec</span><span class="op">(</span><span class="va">subbycol</span><span class="op">)</span>, <span class="fu">rowVec</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">)</span> 
<span class="fu">expect_identical</span><span class="op">(</span><span class="fu">rowToRowMat</span><span class="op">(</span><span class="va">subbycol</span><span class="op">)</span>, <span class="fu">rowToRowMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">)</span>
<span class="fu">expect_identical</span><span class="op">(</span><span class="fu">colToRowMat</span><span class="op">(</span><span class="va">subbycol</span><span class="op">)</span>, <span class="fu">colToRowMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Checking that subsetting to create an empty object is possible:</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">norow</span> <span class="op">&lt;-</span> <span class="va">thing</span><span class="op">[</span><span class="fl">0</span>,<span class="op">]</span>
<span class="fu">expect_true</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/methods/validObject.html">validObject</a></span><span class="op">(</span><span class="va">norow</span><span class="op">)</span><span class="op">)</span>
<span class="fu">expect_identical</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">nrow</a></span><span class="op">(</span><span class="va">norow</span><span class="op">)</span>, <span class="fl">0L</span><span class="op">)</span>

<span class="va">nocol</span> <span class="op">&lt;-</span> <span class="va">thing</span><span class="op">[</span>,<span class="fl">0</span><span class="op">]</span>
<span class="fu">expect_true</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/methods/validObject.html">validObject</a></span><span class="op">(</span><span class="va">nocol</span><span class="op">)</span><span class="op">)</span>
<span class="fu">expect_identical</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">ncol</a></span><span class="op">(</span><span class="va">nocol</span><span class="op">)</span>, <span class="fl">0L</span><span class="op">)</span></code></pre></div>
<p>Subset assignment:</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">modified</span> <span class="op">&lt;-</span> <span class="va">thing</span>
<span class="va">modified</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">thing</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">1</span><span class="op">]</span>

<span class="va">rperm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="fl">5</span><span class="op">:</span><span class="fl">1</span>, <span class="fl">6</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">nrow</a></span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">)</span>
<span class="fu">expect_identical</span><span class="op">(</span><span class="fu">rowVec</span><span class="op">(</span><span class="va">modified</span><span class="op">)</span>, <span class="fu">rowVec</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">[</span><span class="va">rperm</span><span class="op">]</span><span class="op">)</span>
<span class="fu">expect_identical</span><span class="op">(</span><span class="fu">rowToRowMat</span><span class="op">(</span><span class="va">modified</span><span class="op">)</span>, <span class="fu">rowToRowMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">[</span><span class="va">rperm</span>,<span class="op">]</span><span class="op">)</span>
<span class="fu">expect_identical</span><span class="op">(</span><span class="fu">colToRowMat</span><span class="op">(</span><span class="va">modified</span><span class="op">)</span>, <span class="fu">colToRowMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">[</span>,<span class="va">rperm</span><span class="op">]</span><span class="op">)</span>

<span class="va">cperm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">ncol</a></span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">)</span>
<span class="fu">expect_identical</span><span class="op">(</span><span class="fu">colVec</span><span class="op">(</span><span class="va">modified</span><span class="op">)</span>, <span class="fu">colVec</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">[</span><span class="va">cperm</span><span class="op">]</span><span class="op">)</span>
<span class="fu">expect_identical</span><span class="op">(</span><span class="fu">colToColMat</span><span class="op">(</span><span class="va">modified</span><span class="op">)</span>, <span class="fu">colToColMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">[</span>,<span class="va">cperm</span><span class="op">]</span><span class="op">)</span>
<span class="fu">expect_identical</span><span class="op">(</span><span class="fu">rowToColMat</span><span class="op">(</span><span class="va">modified</span><span class="op">)</span>, <span class="fu">rowToColMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">[</span><span class="va">cperm</span>,<span class="op">]</span><span class="op">)</span></code></pre></div>
<p>Checking that we obtain the same object after trivial assignment operations:</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">modified</span> <span class="op">&lt;-</span> <span class="va">thing</span>
<span class="va">modified</span><span class="op">[</span><span class="fl">0</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="va">thing</span><span class="op">[</span><span class="fl">0</span>,<span class="op">]</span>
<span class="fu">expect_equal</span><span class="op">(</span><span class="va">modified</span>, <span class="va">thing</span><span class="op">)</span>
<span class="va">modified</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="va">thing</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>
<span class="fu">expect_equal</span><span class="op">(</span><span class="va">modified</span>, <span class="va">thing</span><span class="op">)</span>
<span class="va">modified</span><span class="op">[</span>,<span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">thing</span><span class="op">[</span>,<span class="fl">0</span><span class="op">]</span>
<span class="fu">expect_equal</span><span class="op">(</span><span class="va">modified</span>, <span class="va">thing</span><span class="op">)</span>
<span class="va">modified</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">thing</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>
<span class="fu">expect_equal</span><span class="op">(</span><span class="va">modified</span>, <span class="va">thing</span><span class="op">)</span></code></pre></div>
<p>We double-check that we can get an error upon invalid assignment:</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">expect_error</span><span class="op">(</span><span class="va">modified</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">thing</span><span class="op">[</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">]</span>, <span class="st">"replacement has length zero"</span><span class="op">)</span></code></pre></div>
</div>
<div id="combining-methods" class="section level2">
<h2 class="hasAnchor">
<a href="#combining-methods" class="anchor"></a>Combining methods</h2>
<p>Combining by row:</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DelayedArray/man/DelayedArray-utils.html">rbind</a></span><span class="op">(</span><span class="va">thing</span>, <span class="va">thing</span><span class="op">)</span>

<span class="va">rtwice</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">nrow</a></span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>
<span class="fu">expect_identical</span><span class="op">(</span><span class="fu">rowVec</span><span class="op">(</span><span class="va">combined</span><span class="op">)</span>, <span class="fu">rowVec</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">[</span><span class="va">rtwice</span><span class="op">]</span><span class="op">)</span>
<span class="fu">expect_identical</span><span class="op">(</span><span class="fu">rowToRowMat</span><span class="op">(</span><span class="va">combined</span><span class="op">)</span>, <span class="fu">rowToRowMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">[</span><span class="va">rtwice</span>,<span class="op">]</span><span class="op">)</span>
<span class="fu">expect_identical</span><span class="op">(</span><span class="fu">colToRowMat</span><span class="op">(</span><span class="va">combined</span><span class="op">)</span>, <span class="fu">colToRowMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">[</span>,<span class="va">rtwice</span><span class="op">]</span><span class="op">)</span>

<span class="co"># Columns are unaffected:</span>
<span class="fu">expect_identical</span><span class="op">(</span><span class="fu">colVec</span><span class="op">(</span><span class="va">combined</span><span class="op">)</span>, <span class="fu">colVec</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">)</span>
<span class="fu">expect_identical</span><span class="op">(</span><span class="fu">colToColMat</span><span class="op">(</span><span class="va">combined</span><span class="op">)</span>, <span class="fu">colToColMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">)</span>
<span class="fu">expect_identical</span><span class="op">(</span><span class="fu">rowToColMat</span><span class="op">(</span><span class="va">combined</span><span class="op">)</span>, <span class="fu">rowToColMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>And combining by column. We use <code>test_equivalent</code> here for simplicity, as column names are altered to preserve uniqueness.</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DelayedArray/man/DelayedArray-utils.html">cbind</a></span><span class="op">(</span><span class="va">thing</span>, <span class="va">thing</span><span class="op">)</span>

<span class="va">ctwice</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">ncol</a></span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>
<span class="fu">expect_equivalent</span><span class="op">(</span><span class="fu">colVec</span><span class="op">(</span><span class="va">combined</span><span class="op">)</span>, <span class="fu">colVec</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">[</span><span class="va">ctwice</span><span class="op">]</span><span class="op">)</span> 
<span class="fu">expect_equivalent</span><span class="op">(</span><span class="fu">colToColMat</span><span class="op">(</span><span class="va">combined</span><span class="op">)</span>, <span class="fu">colToColMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">[</span>,<span class="va">ctwice</span><span class="op">]</span><span class="op">)</span>
<span class="fu">expect_equivalent</span><span class="op">(</span><span class="fu">rowToColMat</span><span class="op">(</span><span class="va">combined</span><span class="op">)</span>, <span class="fu">rowToColMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">[</span><span class="va">ctwice</span>,<span class="op">]</span><span class="op">)</span>

<span class="co"># Rows are unaffected:</span>
<span class="fu">expect_equivalent</span><span class="op">(</span><span class="fu">rowVec</span><span class="op">(</span><span class="va">combined</span><span class="op">)</span>, <span class="fu">rowVec</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">)</span> 
<span class="fu">expect_equivalent</span><span class="op">(</span><span class="fu">rowToRowMat</span><span class="op">(</span><span class="va">combined</span><span class="op">)</span>, <span class="fu">rowToRowMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">)</span>
<span class="fu">expect_equivalent</span><span class="op">(</span><span class="fu">colToRowMat</span><span class="op">(</span><span class="va">combined</span><span class="op">)</span>, <span class="fu">colToRowMat</span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Checking that we get the same object if we combine a single object or an empty object:</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">expect_equal</span><span class="op">(</span><span class="va">thing</span>, <span class="fu"><a href="https://rdrr.io/pkg/DelayedArray/man/DelayedArray-utils.html">rbind</a></span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">)</span>
<span class="fu">expect_equal</span><span class="op">(</span><span class="va">thing</span>, <span class="fu"><a href="https://rdrr.io/pkg/DelayedArray/man/DelayedArray-utils.html">rbind</a></span><span class="op">(</span><span class="va">thing</span>, <span class="va">thing</span><span class="op">[</span><span class="fl">0</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span>

<span class="fu">expect_equal</span><span class="op">(</span><span class="va">thing</span>, <span class="fu"><a href="https://rdrr.io/pkg/DelayedArray/man/DelayedArray-utils.html">cbind</a></span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">)</span>
<span class="fu">expect_equal</span><span class="op">(</span><span class="va">thing</span>, <span class="fu"><a href="https://rdrr.io/pkg/DelayedArray/man/DelayedArray-utils.html">cbind</a></span><span class="op">(</span><span class="va">thing</span>, <span class="va">thing</span><span class="op">[</span>,<span class="fl">0</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>And checking that the compatibility errors are properly thrown:</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">expect_error</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/DelayedArray/man/DelayedArray-utils.html">rbind</a></span><span class="op">(</span><span class="va">thing</span>, <span class="va">thing</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">ncol</a></span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">:</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="st">"not compatible"</span><span class="op">)</span>
<span class="fu">expect_error</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/DelayedArray/man/DelayedArray-utils.html">cbind</a></span><span class="op">(</span><span class="va">thing</span>, <span class="va">thing</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">nrow</a></span><span class="op">(</span><span class="va">thing</span><span class="op">)</span><span class="op">:</span><span class="fl">1</span>,<span class="op">]</span><span class="op">)</span>, <span class="st">"not compatible"</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="documentation" class="section level1">
<h1 class="hasAnchor">
<a href="#documentation" class="anchor"></a>Documentation</h1>
<p>We suggest creating at least two separate documentation (i.e. <code>*.Rd</code>) files. The first file would document the class and the constructor:</p>
<pre><code>\name{ExampleClass class}

\alias{ExampleClass-class}
\alias{ExampleClass}

\title{The ExampleClass class}
\description{An overview of the ExampleClass class and constructor.}

\usage{
ExampleClass(rowVec=integer(0), colVec=integer(0),
    # etc., etc., I won't write it all out here.
)
}

\arguments{
    \item{rowVec}{An integer vector mapping to the rows, representing
        something important.}

    \item{colVec}{An integer vector mapping to the columns, representing
        something else that's important.}

    % And so on...
}

\details{
    % Some context on why this class and its slots are necessary.
    The ExampleClass provides an example of how to derive from the
    SummarizedExperiment class.  Its slots have no scientific meaning and
    are purely for demonstration purposes.
}</code></pre>
<p>The second file would document all of the individual methods:</p>
<pre><code>\name{ExampleClass methods}

% New generics:
\alias{rowVec}
\alias{rowVec,ExampleClass-method}
\alias{rowVec&lt;-}
\alias{rowVec&lt;-,ExampleClass-method}
%% And so on...

% Already have a generic:
\alias{[,ExampleClass-method}
\alias{[,ExampleClass,ANY-method}
\alias{[,ExampleClass,ANY,ANY-method}

\alias{rbind,ExampleClass-method}
%% And so on...

\title{ExampleClass methods}
\description{Methods for the ExampleClass class.}

\usage{
\S4method{rowVec}{ExampleClass}(x, withDimnames=FALSE)

\S4method{rowVec}{ExampleClass}(x) &lt;- value

\S4method{[}{ExampleClass}(x, i, j, drop=TRUE)

\S4method{rbind}{ExampleClass}(..., , i, j, drop=TRUE)

%% And so on...
}

\arguments{
    \item{x}{An ExampleClass object.}

    \item{withDimnames}{A logical scalar indicating whether dimension names
        from \code{x} should be returned.}

    \item{value}{
        For \code{rowVec}, an integer vector of length equal to the number of 
        rows.

        For \code{colVec}, an integer vector of length equal to the number of 
        columns.
    }

    %% And so on...
}

\section{Accessors}{
    % Add some details about accessor behaviour here.
}

\section{Subsetting}{
    % Add some details about subsetting behaviour here.
}

\section{Combining}{
    % Add some details about combining behaviour here.
}</code></pre>
</div>
<div id="session-information" class="section level1">
<h1 class="hasAnchor">
<a href="#session-information" class="anchor"></a>Session information</h1>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## R version 4.1.0 RC (2021-05-10 r80294)
## Platform: aarch64-apple-darwin20 (64-bit)
## Running under: macOS Big Sur 11.6
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/lib/libRblas.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] parallel  stats4    stats     graphics  grDevices utils     datasets 
## [8] methods   base     
## 
## other attached packages:
##  [1] testthat_3.1.0                    SummarizedExperimentGHA_1.23.5003
##  [3] Biobase_2.52.0                    GenomicRanges_1.45.0001          
##  [5] GenomeInfoDb_1.28.4               IRanges_2.26.0                   
##  [7] S4Vectors_0.30.2                  BiocGenerics_0.38.0              
##  [9] MatrixGenerics_1.4.3              matrixStats_0.61.0               
## [11] BiocStyle_2.20.2                 
## 
## loaded via a namespace (and not attached):
##  [1] bslib_0.3.1            compiler_4.1.0         BiocManager_1.30.16   
##  [4] jquerylib_0.1.4        XVector_0.32.0         zlibbioc_1.38.0       
##  [7] bitops_1.0-7           tools_4.1.0            pkgload_1.2.3         
## [10] digest_0.6.28          lattice_0.20-45        jsonlite_1.7.2        
## [13] evaluate_0.14          memoise_2.0.0          rlang_0.4.12          
## [16] Matrix_1.3-4           DelayedArray_0.19.0    yaml_2.2.1            
## [19] pkgdown_1.6.1          xfun_0.27              fastmap_1.1.0         
## [22] GenomeInfoDbData_1.2.6 withr_2.4.2            stringr_1.4.0         
## [25] knitr_1.36             desc_1.4.0             fs_1.5.0              
## [28] sass_0.4.0             systemfonts_1.0.3      grid_4.1.0            
## [31] rprojroot_2.0.2        glue_1.4.2             R6_2.5.1              
## [34] textshaping_0.3.6      rmarkdown_2.11         bookdown_0.24         
## [37] waldo_0.3.1            magrittr_2.0.1         htmltools_0.5.2       
## [40] ragg_1.1.3             stringi_1.7.5          RCurl_1.98-1.5        
## [43] cachem_1.0.6           crayon_1.4.1</code></pre>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>For simplicity’s sake, we won’t worry about enforcing integer type, as fractional values are possible, e.g., when dealing with expected counts.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>This allows us to turn off the validity checks in internal functions where intermediate objects may not be valid within the scope of the function.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>If you have an idea for a generally applicable generic that is not yet available, please contact the Bioconductor core team.<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>The <code>...</code> in the generic function definition means that custom arguments like <code>withDimnames=</code> can be provided for specific methods, if necessary.<a href="#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>It does no harm to repeat the Roxygen tags, which explicitly specifies the imports required for each class and function.<a href="#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p>This protects against changes to the slot names, and simplifies development when the storage mode differs from the conceptual meaning of the data, e.g., for efficiency purposes.<a href="#fnref6" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Bioconductor Maintainer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
